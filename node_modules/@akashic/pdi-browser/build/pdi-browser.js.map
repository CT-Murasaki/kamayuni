{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "lib/AudioManager.js",
    "lib/ContainerController.js",
    "lib/InputHandlerLayer.js",
    "lib/Platform.js",
    "lib/RafLooper.js",
    "lib/ResourceFactory.js",
    "lib/asset/HTMLImageAsset.js",
    "lib/asset/HTMLVideoAsset.js",
    "lib/asset/HTMLVideoPlayer.js",
    "lib/asset/XHRScriptAsset.js",
    "lib/asset/XHRTextAsset.js",
    "lib/canvas/CanvasSurface.js",
    "lib/canvas/Context2DRenderer.js",
    "lib/canvas/GlyphFactory.js",
    "lib/canvas/RenderingHelper.js",
    "lib/canvas/SurfaceFactory.js",
    "lib/handler/InputAbstractHandler.js",
    "lib/handler/MouseHandler.js",
    "lib/handler/TouchHandler.js",
    "lib/plugin/AudioPluginManager.js",
    "lib/plugin/AudioPluginRegistry.js",
    "lib/plugin/HTMLAudioPlugin/HTMLAudioAsset.js",
    "lib/plugin/HTMLAudioPlugin/HTMLAudioAutoplayHelper.js",
    "lib/plugin/HTMLAudioPlugin/HTMLAudioPlayer.js",
    "lib/plugin/HTMLAudioPlugin/HTMLAudioPlugin.js",
    "lib/plugin/ProxyAudioPlugin/ProxyAudioAsset.js",
    "lib/plugin/ProxyAudioPlugin/ProxyAudioPlayer.js",
    "lib/plugin/ProxyAudioPlugin/ProxyAudioPlugin.js",
    "lib/plugin/WebAudioPlugin/WebAudioAsset.js",
    "lib/plugin/WebAudioPlugin/WebAudioAutoplayHelper.js",
    "lib/plugin/WebAudioPlugin/WebAudioHelper.js",
    "lib/plugin/WebAudioPlugin/WebAudioPlayer.js",
    "lib/plugin/WebAudioPlugin/WebAudioPlugin.js",
    "lib/utils/XHRLoader.js",
    "node_modules/@akashic/akashic-pdi/lib/index.js",
    "lib/index.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AudioManager = void 0;\nvar AudioManager = /** @class */ (function () {\n    function AudioManager() {\n        this.audioAssets = [];\n        this._masterVolume = 1.0;\n    }\n    AudioManager.prototype.registerAudioAsset = function (asset) {\n        if (this.audioAssets.indexOf(asset) === -1)\n            this.audioAssets.push(asset);\n    };\n    AudioManager.prototype.removeAudioAsset = function (asset) {\n        var index = this.audioAssets.indexOf(asset);\n        if (index === -1)\n            this.audioAssets.splice(index, 1);\n    };\n    AudioManager.prototype.setMasterVolume = function (volume) {\n        this._masterVolume = volume;\n        for (var i = 0; i < this.audioAssets.length; i++) {\n            if (this.audioAssets[i]._lastPlayedPlayer) {\n                this.audioAssets[i]._lastPlayedPlayer.notifyMasterVolumeChanged();\n            }\n        }\n    };\n    AudioManager.prototype.getMasterVolume = function () {\n        return this._masterVolume;\n    };\n    return AudioManager;\n}());\nexports.AudioManager = AudioManager;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ContainerController = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar RenderingHelper_1 = require(\"./canvas/RenderingHelper\");\nvar InputHandlerLayer_1 = require(\"./InputHandlerLayer\");\n/*\n HTML要素のContainerを管理するクラス。\n CanvasやInputHandlerの実態となる要素の順番や追加済みなのかを管理する。\n ContainerはInput、Canvasを1つのセットとして扱う。\n\n 以下のようなDOM構造を持つ\n\n ContainerController.rootView\n └── InputHandlerLayer\n     └── CanvasSurface\n */\nvar ContainerController = /** @class */ (function () {\n    function ContainerController() {\n        this.container = null;\n        this.surface = null;\n        this.inputHandlerLayer = null;\n        this.rootView = null;\n        this.useResizeForScaling = false;\n        this.pointEventTrigger = new g.Trigger();\n        this._rendererReq = null;\n        this._disablePreventDefault = false;\n    }\n    ContainerController.prototype.initialize = function (param) {\n        this._rendererReq = param.rendererRequirement;\n        this._disablePreventDefault = !!param.disablePreventDefault;\n        this._loadView();\n    };\n    ContainerController.prototype.setRootView = function (rootView) {\n        if (rootView === this.rootView) {\n            return;\n        }\n        // 一つのContainerは一つのrootしか持たないのでloadし直す\n        if (this.rootView) {\n            this.unloadView();\n            this._loadView();\n        }\n        this.rootView = rootView;\n        this._appendToRootView(rootView);\n    };\n    ContainerController.prototype.resetView = function (rendererReq) {\n        this.unloadView();\n        this._rendererReq = rendererReq;\n        this._loadView();\n        this._appendToRootView(this.rootView);\n    };\n    ContainerController.prototype.getRenderer = function () {\n        if (!this.surface) {\n            throw new Error(\"this container has no surface\");\n        }\n        // TODO: should be cached?\n        return this.surface.renderer();\n    };\n    ContainerController.prototype.changeScale = function (xScale, yScale) {\n        if (this.useResizeForScaling) {\n            this.surface.changePhysicalScale(xScale, yScale);\n        }\n        else {\n            this.surface.changeVisualScale(xScale, yScale);\n        }\n        this.inputHandlerLayer._inputHandler.setScale(xScale, yScale);\n    };\n    ContainerController.prototype.unloadView = function () {\n        // イベントを片付けてから、rootViewに所属するElementを開放する\n        this.inputHandlerLayer.disablePointerEvent();\n        if (this.rootView) {\n            while (this.rootView.firstChild) {\n                this.rootView.removeChild(this.rootView.firstChild);\n            }\n        }\n    };\n    ContainerController.prototype._loadView = function () {\n        var _a = this._rendererReq, width = _a.primarySurfaceWidth, height = _a.primarySurfaceHeight, rc = _a.rendererCandidates;\n        var disablePreventDefault = this._disablePreventDefault;\n        // DocumentFragmentはinsertした時点で開放されているため毎回作る\n        // https://dom.spec.whatwg.org/#concept-node-insert\n        this.container = document.createDocumentFragment();\n        // 入力受け付けレイヤー - DOM Eventの管理\n        if (!this.inputHandlerLayer) {\n            this.inputHandlerLayer = new InputHandlerLayer_1.InputHandlerLayer({ width: width, height: height, disablePreventDefault: disablePreventDefault });\n        }\n        else {\n            // Note: 操作プラグインに与えた view 情報を削除しないため、 inputHandlerLayer を使いまわしている\n            this.inputHandlerLayer.setViewSize({ width: width, height: height });\n            this.inputHandlerLayer.pointEventTrigger._reset();\n            this.inputHandlerLayer.view.removeChild(this.surface.canvas);\n            this.surface.destroy();\n        }\n        // 入力受け付けレイヤー > 描画レイヤー\n        this.surface = RenderingHelper_1.RenderingHelper.createPrimarySurface(width, height, rc);\n        this.inputHandlerLayer.view.appendChild(this.surface.getHTMLElement());\n        // containerController -> input -> canvas\n        this.container.appendChild(this.inputHandlerLayer.view);\n    };\n    ContainerController.prototype._appendToRootView = function (rootView) {\n        rootView.appendChild(this.container);\n        this.inputHandlerLayer.enablePointerEvent(); // Viewが追加されてから設定する\n        this.inputHandlerLayer.pointEventTrigger.handle(this.pointEventTrigger, this.pointEventTrigger.fire);\n    };\n    return ContainerController;\n}());\nexports.ContainerController = ContainerController;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InputHandlerLayer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar TouchHandler_1 = require(\"./handler/TouchHandler\");\n/**\n * ユーザの入力を受け付けるViewのレイヤー。\n *\n * 実行環境に適切なDOMイベントを設定し、DOMイベントから座標データへ変換した結果をGameに伝える。\n * InputHandlerLayerはあくまで一つのレイヤーであり、Containerではない。\n * 従ってこのViewの親子要素がどうなっているかを知る必要はない。\n */\nvar InputHandlerLayer = /** @class */ (function () {\n    /**\n     * @example\n     *\n     * var inputHandlerLayer = new InputHandlerLayer();\n     * inputHandlerLayer.pointEventTrigger.handle(function(pointEvent){\n     *   console.log(pointEvent);\n     * });\n     * containerController.appendChild(inputHandlerLayer.view);\n     */\n    function InputHandlerLayer(param) {\n        this.view = this._createInputView(param.width, param.height);\n        this._inputHandler = undefined;\n        this.pointEventTrigger = new g.Trigger();\n        this._disablePreventDefault = !!param.disablePreventDefault;\n    }\n    // 実行環境でサポートしてるDOM Eventを使い、それぞれonPoint*Triggerを関連付ける\n    InputHandlerLayer.prototype.enablePointerEvent = function () {\n        var _this = this;\n        this._inputHandler = new TouchHandler_1.TouchHandler(this.view, this._disablePreventDefault);\n        // 各種イベントのTrigger\n        this._inputHandler.pointTrigger.handle(function (e) {\n            _this.pointEventTrigger.fire(e);\n        });\n        this._inputHandler.start();\n    };\n    // DOMイベントハンドラを開放する\n    InputHandlerLayer.prototype.disablePointerEvent = function () {\n        if (this._inputHandler)\n            this._inputHandler.stop();\n    };\n    InputHandlerLayer.prototype.setOffset = function (offset) {\n        var inputViewStyle = \"position:relative; left:\" + offset.x + \"px; top:\" + offset.y + \"px\";\n        this._inputHandler.inputView.setAttribute(\"style\", inputViewStyle);\n    };\n    InputHandlerLayer.prototype.setViewSize = function (size) {\n        var view = this.view;\n        view.style.width = size.width + \"px\";\n        view.style.height = size.height + \"px\";\n    };\n    InputHandlerLayer.prototype._createInputView = function (width, height) {\n        var view = document.createElement(\"div\");\n        view.setAttribute(\"tabindex\", \"1\");\n        view.className = \"input-handler\";\n        view.setAttribute(\"style\", \"display:inline-block; outline:none;\");\n        view.style.width = width + \"px\";\n        view.style.height = height + \"px\";\n        return view;\n    };\n    return InputHandlerLayer;\n}());\nexports.InputHandlerLayer = InputHandlerLayer;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Platform = void 0;\nvar RafLooper_1 = require(\"./RafLooper\");\nvar ResourceFactory_1 = require(\"./ResourceFactory\");\nvar ContainerController_1 = require(\"./ContainerController\");\nvar AudioPluginManager_1 = require(\"./plugin/AudioPluginManager\");\nvar AudioManager_1 = require(\"./AudioManager\");\nvar AudioPluginRegistry_1 = require(\"./plugin/AudioPluginRegistry\");\nvar XHRTextAsset_1 = require(\"./asset/XHRTextAsset\");\nvar Platform = /** @class */ (function () {\n    function Platform(param) {\n        this.containerView = param.containerView;\n        this.containerController = new ContainerController_1.ContainerController();\n        this.audioPluginManager = new AudioPluginManager_1.AudioPluginManager();\n        if (param.audioPlugins) {\n            this.audioPluginManager.tryInstallPlugin(param.audioPlugins);\n        }\n        // TODO: make it deprecated\n        this.audioPluginManager.tryInstallPlugin(AudioPluginRegistry_1.AudioPluginRegistry.getRegisteredAudioPlugins());\n        this._audioManager = new AudioManager_1.AudioManager();\n        this.amflow = param.amflow;\n        this._platformEventHandler = null;\n        this._resourceFactory = param.resourceFactory || new ResourceFactory_1.ResourceFactory({\n            audioPluginManager: this.audioPluginManager,\n            platform: this,\n            audioManager: this._audioManager\n        });\n        this._rendererReq = null;\n        this._disablePreventDefault = !!param.disablePreventDefault;\n    }\n    Platform.prototype.setPlatformEventHandler = function (handler) {\n        if (this.containerController) {\n            this.containerController.pointEventTrigger.removeAll(this._platformEventHandler);\n            this.containerController.pointEventTrigger.handle(handler, handler.onPointEvent);\n        }\n        this._platformEventHandler = handler;\n    };\n    Platform.prototype.loadGameConfiguration = function (url, callback) {\n        var a = new XHRTextAsset_1.XHRTextAsset(\"(game.json)\", url);\n        a._load({\n            _onAssetLoad: function (asset) { callback(null, JSON.parse(a.data)); },\n            _onAssetError: function (asset, error) { callback(error, null); }\n        });\n    };\n    Platform.prototype.getResourceFactory = function () {\n        return this._resourceFactory;\n    };\n    Platform.prototype.setRendererRequirement = function (requirement) {\n        if (!requirement) {\n            if (this.containerController)\n                this.containerController.unloadView();\n            return;\n        }\n        this._rendererReq = requirement;\n        this._resourceFactory._rendererCandidates = this._rendererReq.rendererCandidates;\n        // Note: this.containerController.inputHandlerLayer の存在により this.containerController が初期化されているかを判定\n        if (this.containerController && !this.containerController.inputHandlerLayer) {\n            this.containerController.initialize({\n                rendererRequirement: requirement,\n                disablePreventDefault: this._disablePreventDefault\n            });\n            this.containerController.setRootView(this.containerView);\n            if (this._platformEventHandler) {\n                this.containerController.pointEventTrigger.handle(this._platformEventHandler, this._platformEventHandler.onPointEvent);\n            }\n        }\n        else {\n            var surface = this.getPrimarySurface();\n            if (surface && !surface.destroyed())\n                surface.destroy();\n            this.containerController.resetView(requirement);\n        }\n    };\n    Platform.prototype.getPrimarySurface = function () {\n        return this.containerController.surface;\n    };\n    Platform.prototype.getOperationPluginViewInfo = function () {\n        var _this = this;\n        return {\n            type: \"pdi-browser\",\n            view: this.containerController.inputHandlerLayer.view,\n            getScale: function () { return _this.containerController.inputHandlerLayer._inputHandler.getScale(); }\n        };\n    };\n    Platform.prototype.createLooper = function (fun) {\n        return new RafLooper_1.RafLooper(fun);\n    };\n    Platform.prototype.sendToExternal = function (playId, data) {\n        // Nothing to do.\n    };\n    Platform.prototype.registerAudioPlugins = function (plugins) {\n        return this.audioPluginManager.tryInstallPlugin(plugins);\n    };\n    Platform.prototype.setScale = function (xScale, yScale) {\n        this.containerController.changeScale(xScale, yScale);\n    };\n    Platform.prototype.notifyViewMoved = function () {\n        // 既に役割のないメソッド(呼び出さなくても正しく動作する)。公開APIのため後方互換性のために残している。\n    };\n    /**\n     * 最終的に出力されるマスター音量を変更する\n     *\n     * @param volume マスター音量\n     */\n    Platform.prototype.setMasterVolume = function (volume) {\n        if (this._audioManager)\n            this._audioManager.setMasterVolume(volume);\n    };\n    /**\n     * 最終的に出力されるマスター音量を取得する\n     */\n    Platform.prototype.getMasterVolume = function () {\n        if (this._audioManager)\n            return this._audioManager.getMasterVolume();\n    };\n    Platform.prototype.destroy = function () {\n        this.setRendererRequirement(undefined);\n        this.setMasterVolume(0);\n    };\n    return Platform;\n}());\nexports.Platform = Platform;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RafLooper = void 0;\nvar RafLooper = /** @class */ (function () {\n    function RafLooper(fun) {\n        this._fun = fun;\n        this._timerId = undefined;\n        this._prev = 0;\n    }\n    RafLooper.prototype.start = function () {\n        var _this = this;\n        var onAnimationFrame = function (deltaTime) {\n            if (_this._timerId == null) {\n                // NOTE: Firefox Quantum 57.0.2の不具合(？)(cancelAnimationFrame()が機能しないことがある)暫定対策\n                return;\n            }\n            _this._timerId = requestAnimationFrame(onAnimationFrame);\n            _this._fun(deltaTime - _this._prev);\n            _this._prev = deltaTime;\n        };\n        var onFirstFrame = function (deltaTime) {\n            _this._timerId = requestAnimationFrame(onAnimationFrame);\n            _this._fun(0);\n            _this._prev = deltaTime;\n        };\n        this._timerId = requestAnimationFrame(onFirstFrame);\n    };\n    RafLooper.prototype.stop = function () {\n        cancelAnimationFrame(this._timerId);\n        this._timerId = undefined;\n        this._prev = 0;\n    };\n    return RafLooper;\n}());\nexports.RafLooper = RafLooper;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResourceFactory = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar HTMLImageAsset_1 = require(\"./asset/HTMLImageAsset\");\nvar HTMLVideoAsset_1 = require(\"./asset/HTMLVideoAsset\");\nvar XHRTextAsset_1 = require(\"./asset/XHRTextAsset\");\nvar XHRScriptAsset_1 = require(\"./asset/XHRScriptAsset\");\nvar RenderingHelper_1 = require(\"./canvas/RenderingHelper\");\nvar GlyphFactory_1 = require(\"./canvas/GlyphFactory\");\nvar ResourceFactory = /** @class */ (function (_super) {\n    __extends(ResourceFactory, _super);\n    function ResourceFactory(param) {\n        var _this = _super.call(this) || this;\n        _this._audioPluginManager = param.audioPluginManager;\n        _this._audioManager = param.audioManager;\n        _this._platform = param.platform;\n        return _this;\n    }\n    ResourceFactory.prototype.createAudioAsset = function (id, assetPath, duration, system, loop, hint) {\n        var activePlugin = this._audioPluginManager.getActivePlugin();\n        var audioAsset = activePlugin.createAsset(id, assetPath, duration, system, loop, hint);\n        if (audioAsset.onDestroyed) {\n            this._audioManager.registerAudioAsset(audioAsset);\n            audioAsset.onDestroyed.handle(this, this._onAudioAssetDestroyed);\n        }\n        return audioAsset;\n    };\n    ResourceFactory.prototype.createAudioPlayer = function (system) {\n        var activePlugin = this._audioPluginManager.getActivePlugin();\n        return activePlugin.createPlayer(system, this._audioManager);\n    };\n    ResourceFactory.prototype.createImageAsset = function (id, assetPath, width, height) {\n        return new HTMLImageAsset_1.HTMLImageAsset(id, assetPath, width, height);\n    };\n    ResourceFactory.prototype.createVideoAsset = function (id, assetPath, width, height, system, loop, useRealSize) {\n        return new HTMLVideoAsset_1.HTMLVideoAsset(id, assetPath, width, height, system, loop, useRealSize);\n    };\n    ResourceFactory.prototype.createTextAsset = function (id, assetPath) {\n        return new XHRTextAsset_1.XHRTextAsset(id, assetPath);\n    };\n    ResourceFactory.prototype.createScriptAsset = function (id, assetPath) {\n        return new XHRScriptAsset_1.XHRScriptAsset(id, assetPath);\n    };\n    ResourceFactory.prototype.createSurface = function (width, height) {\n        return RenderingHelper_1.RenderingHelper.createBackSurface(width, height, this._platform, this._rendererCandidates);\n    };\n    ResourceFactory.prototype.createGlyphFactory = function (fontFamily, fontSize, baseline, fontColor, strokeWidth, strokeColor, strokeOnly, fontWeight) {\n        return new GlyphFactory_1.GlyphFactory(fontFamily, fontSize, baseline, fontColor, strokeWidth, strokeColor, strokeOnly, fontWeight);\n    };\n    ResourceFactory.prototype._onAudioAssetDestroyed = function (asset) {\n        this._audioManager.removeAudioAsset(asset);\n    };\n    return ResourceFactory;\n}(g.ResourceFactory));\nexports.ResourceFactory = ResourceFactory;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLImageAsset = exports.ImageAssetSurface = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar ImageAssetSurface = /** @class */ (function (_super) {\n    __extends(ImageAssetSurface, _super);\n    function ImageAssetSurface(width, height, drawable) {\n        return _super.call(this, width, height, drawable) || this;\n    }\n    ImageAssetSurface.prototype.renderer = function () {\n        throw g.ExceptionFactory.createAssertionError(\"ImageAssetSurface cannot be rendered.\");\n    };\n    ImageAssetSurface.prototype.isPlaying = function () {\n        return false;\n    };\n    return ImageAssetSurface;\n}(g.Surface));\nexports.ImageAssetSurface = ImageAssetSurface;\nvar HTMLImageAsset = /** @class */ (function (_super) {\n    __extends(HTMLImageAsset, _super);\n    function HTMLImageAsset(id, path, width, height) {\n        var _this = _super.call(this, id, path, width, height) || this;\n        _this.data = undefined;\n        _this._surface = undefined;\n        return _this;\n    }\n    HTMLImageAsset.prototype.destroy = function () {\n        if (this._surface && !this._surface.destroyed()) {\n            this._surface.destroy();\n        }\n        this.data = undefined;\n        this._surface = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    HTMLImageAsset.prototype._load = function (loader) {\n        var _this = this;\n        var image = new Image();\n        image.onerror = function () {\n            loader._onAssetError(_this, g.ExceptionFactory.createAssetLoadError(\"HTMLImageAsset unknown loading error\"));\n        };\n        image.onload = function () {\n            _this.data = image;\n            loader._onAssetLoad(_this);\n        };\n        image.src = this.path;\n    };\n    HTMLImageAsset.prototype.asSurface = function () {\n        if (!this.data) {\n            throw g.ExceptionFactory.createAssertionError(\"ImageAssetImpl#asSurface: not yet loaded.\");\n        }\n        if (this._surface) {\n            return this._surface;\n        }\n        this._surface = new ImageAssetSurface(this.width, this.height, this.data);\n        return this._surface;\n    };\n    return HTMLImageAsset;\n}(g.ImageAsset));\nexports.HTMLImageAsset = HTMLImageAsset;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLVideoAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar HTMLVideoPlayer_1 = require(\"./HTMLVideoPlayer\");\nvar VideoAssetSurface = /** @class */ (function (_super) {\n    __extends(VideoAssetSurface, _super);\n    function VideoAssetSurface(width, height, drawable) {\n        return _super.call(this, width, height, drawable, true) || this;\n    }\n    VideoAssetSurface.prototype.renderer = function () {\n        throw g.ExceptionFactory.createAssertionError(\"VideoAssetSurface cannot be rendered.\");\n    };\n    VideoAssetSurface.prototype.isPlaying = function () {\n        return false;\n    };\n    return VideoAssetSurface;\n}(g.Surface));\nvar HTMLVideoAsset = /** @class */ (function (_super) {\n    __extends(HTMLVideoAsset, _super);\n    function HTMLVideoAsset(id, assetPath, width, height, system, loop, useRealSize) {\n        var _this = _super.call(this, id, assetPath, width, height, system, loop, useRealSize) || this;\n        _this._player = new HTMLVideoPlayer_1.HTMLVideoPlayer();\n        _this._surface = new VideoAssetSurface(width, height, null);\n        return _this;\n    }\n    HTMLVideoAsset.prototype.inUse = function () {\n        return false;\n    };\n    HTMLVideoAsset.prototype._load = function (loader) {\n        var _this = this;\n        setTimeout(function () {\n            loader._onAssetLoad(_this);\n        }, 0);\n    };\n    HTMLVideoAsset.prototype.getPlayer = function () {\n        return this._player;\n    };\n    HTMLVideoAsset.prototype.asSurface = function () {\n        return this._surface;\n    };\n    return HTMLVideoAsset;\n}(g.VideoAsset));\nexports.HTMLVideoAsset = HTMLVideoAsset;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLVideoPlayer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar HTMLVideoPlayer = /** @class */ (function (_super) {\n    __extends(HTMLVideoPlayer, _super);\n    function HTMLVideoPlayer(loop) {\n        var _this = _super.call(this, loop) || this;\n        _this.isDummy = true;\n        return _this;\n    }\n    HTMLVideoPlayer.prototype.play = function (videoAsset) {\n        // not yet supported\n    };\n    HTMLVideoPlayer.prototype.stop = function () {\n        // not yet supported\n    };\n    HTMLVideoPlayer.prototype.changeVolume = function (volume) {\n        // not yet supported\n    };\n    return HTMLVideoPlayer;\n}(g.VideoPlayer));\nexports.HTMLVideoPlayer = HTMLVideoPlayer;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.XHRScriptAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar XHRLoader_1 = require(\"../utils/XHRLoader\");\nvar XHRScriptAsset = /** @class */ (function (_super) {\n    __extends(XHRScriptAsset, _super);\n    function XHRScriptAsset(id, path) {\n        var _this = _super.call(this, id, path) || this;\n        _this.script = undefined;\n        return _this;\n    }\n    XHRScriptAsset.prototype._load = function (handler) {\n        var _this = this;\n        var loader = new XHRLoader_1.XHRLoader();\n        loader.get(this.path, function (error, responseText) {\n            if (error) {\n                handler._onAssetError(_this, error);\n                return;\n            }\n            _this.script = responseText + \"\\n\";\n            handler._onAssetLoad(_this);\n        });\n    };\n    XHRScriptAsset.prototype.execute = function (execEnv) {\n        // TODO: この方式では読み込んだスクリプトがcookie参照できる等本質的な危険性がある\n        // 信頼できないスクリプトを読み込むようなケースでは、iframeに閉じ込めて実行などの方式を検討する事。\n        var func = this._wrap();\n        func(execEnv);\n        return execEnv.module.exports;\n    };\n    XHRScriptAsset.prototype._wrap = function () {\n        var func = new Function(\"g\", XHRScriptAsset.PRE_SCRIPT + this.script + XHRScriptAsset.POST_SCRIPT);\n        return func;\n    };\n    XHRScriptAsset.PRE_SCRIPT = \"(function(exports, require, module, __filename, __dirname) {\";\n    XHRScriptAsset.POST_SCRIPT = \"\\n})(g.module.exports, g.module.require, g.module, g.filename, g.dirname);\";\n    return XHRScriptAsset;\n}(g.ScriptAsset));\nexports.XHRScriptAsset = XHRScriptAsset;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.XHRTextAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar XHRLoader_1 = require(\"../utils/XHRLoader\");\nvar XHRTextAsset = /** @class */ (function (_super) {\n    __extends(XHRTextAsset, _super);\n    function XHRTextAsset(id, path) {\n        var _this = _super.call(this, id, path) || this;\n        _this.data = undefined;\n        return _this;\n    }\n    XHRTextAsset.prototype._load = function (handler) {\n        var _this = this;\n        var loader = new XHRLoader_1.XHRLoader();\n        loader.get(this.path, function (error, responseText) {\n            if (error) {\n                handler._onAssetError(_this, error);\n                return;\n            }\n            _this.data = responseText;\n            handler._onAssetLoad(_this);\n        });\n    };\n    return XHRTextAsset;\n}(g.TextAsset));\nexports.XHRTextAsset = XHRTextAsset;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CanvasSurface = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar Context2DRenderer_1 = require(\"./Context2DRenderer\");\nvar CanvasSurface = /** @class */ (function (_super) {\n    __extends(CanvasSurface, _super);\n    function CanvasSurface(width, height) {\n        var _this = this;\n        var canvas = document.createElement(\"canvas\");\n        _this = _super.call(this, width, height, canvas) || this;\n        canvas.width = width;\n        canvas.height = height;\n        _this.canvas = canvas;\n        _this._context = canvas.getContext(\"2d\");\n        _this._renderer = undefined;\n        return _this;\n    }\n    CanvasSurface.prototype.destroy = function () {\n        this.canvas.width = 1;\n        this.canvas.height = 1;\n        this.canvas = null;\n        this._renderer = null;\n        _super.prototype.destroy.call(this);\n    };\n    CanvasSurface.prototype.renderer = function () {\n        if (!this._renderer) {\n            this._renderer = new Context2DRenderer_1.Context2DRenderer(this, this._context);\n        }\n        return this._renderer;\n    };\n    CanvasSurface.prototype.getHTMLElement = function () {\n        return this.canvas;\n    };\n    /**\n     * 描き込み時の拡大率(と描画領域のサイズ)を変更する。\n     * このメソッドによって描画領域のサイズは変化し、それにより表示上のサイズも変化するが、\n     * 「ゲームコンテンツから見たサーフェスとしてのサイズ」(生成時に指定されたサイズ)は変わらない点に注意。\n     *\n     * このメソッドと `changeVisualScale()` との違いは、拡大時、高解像度の画像の縮小して描き込む時に現れる。\n     * このメソッドによる拡大は、表示上の拡大率のみを変更する `changeVisualScale()` と異なり、\n     * 「縮小と拡大の変換行列をかけて大きなcanvasに描き込む」ことになるため、描画元の解像度を活かすことができる。\n     *\n     * このメソッドは、このサーフェスへの描画中(`this.renderer().begin()` から `end()` までの間)に呼び出してはならない。\n     */\n    CanvasSurface.prototype.changePhysicalScale = function (xScale, yScale) {\n        this.canvas.width = this.width * xScale;\n        this.canvas.height = this.height * yScale;\n        this._context.scale(xScale, yScale);\n    };\n    /**\n     * 表示上の拡大率を変更する。\n     * `changeRawSize()` との差異に注意。\n     */\n    CanvasSurface.prototype.changeVisualScale = function (xScale, yScale) {\n        /*\n         Canvas要素のリサイズをCSS transformで行う。\n         CSSのwidth/height styleによるリサイズはおかしくなるケースが存在するので、可能な限りtransformを使う。\n         - https://twitter.com/uupaa/status/639002317576998912\n         - http://havelog.ayumusato.com/develop/performance/e554-paint_gpu_acceleration_problems.html\n         - http://buccchi.jp/blog/2013/03/android_canvas_deathpoint/\n         */\n        var canvasStyle = this.canvas.style;\n        if (\"transform\" in canvasStyle) {\n            canvasStyle.transformOrigin = \"0 0\";\n            canvasStyle.transform = \"scale(\" + xScale + \",\" + yScale + \")\";\n        }\n        else if (\"webkitTransform\" in canvasStyle) {\n            canvasStyle.webkitTransformOrigin = \"0 0\";\n            canvasStyle.webkitTransform = \"scale(\" + xScale + \",\" + yScale + \")\";\n        }\n        else {\n            canvasStyle.width = Math.floor(xScale * this.width) + \"px\";\n            canvasStyle.height = Math.floor(yScale * this.width) + \"px\";\n        }\n    };\n    CanvasSurface.prototype.isPlaying = function () {\n        throw g.ExceptionFactory.createAssertionError(\"CanvasSurface#isPlaying() is not implemented\");\n    };\n    return CanvasSurface;\n}(g.Surface));\nexports.CanvasSurface = CanvasSurface;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Context2DRenderer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar RenderingHelper_1 = require(\"./RenderingHelper\");\nvar Context2DRenderer = /** @class */ (function (_super) {\n    __extends(Context2DRenderer, _super);\n    function Context2DRenderer(surface, context) {\n        var _this = _super.call(this) || this;\n        _this.surface = surface;\n        _this.context = context;\n        return _this;\n    }\n    Context2DRenderer.prototype.clear = function () {\n        this.context.clearRect(0, 0, this.surface.width, this.surface.height);\n    };\n    Context2DRenderer.prototype.drawImage = function (surface, offsetX, offsetY, width, height, canvasOffsetX, canvasOffsetY) {\n        this.context.drawImage(surface._drawable, offsetX, offsetY, width, height, canvasOffsetX, canvasOffsetY, width, height);\n    };\n    Context2DRenderer.prototype.drawSprites = function (surface, offsetX, offsetY, width, height, canvasOffsetX, canvasOffsetY, count) {\n        for (var i = 0; i < count; ++i) {\n            this.drawImage(surface, offsetX[i], offsetY[i], width[i], height[i], canvasOffsetX[i], canvasOffsetY[i]);\n        }\n    };\n    Context2DRenderer.prototype.drawSystemText = function (text, x, y, maxWidth, fontSize, textAlign, textBaseline, textColor, fontFamily, strokeWidth, strokeColor, strokeOnly) {\n        RenderingHelper_1.RenderingHelper.drawSystemTextByContext2D(this.context, text, x, y, maxWidth, fontSize, textAlign, textBaseline, textColor, fontFamily, strokeWidth, strokeColor, strokeOnly);\n    };\n    Context2DRenderer.prototype.translate = function (x, y) {\n        this.context.translate(x, y);\n    };\n    Context2DRenderer.prototype.transform = function (matrix) {\n        this.context.transform.apply(this.context, matrix);\n    };\n    Context2DRenderer.prototype.opacity = function (opacity) {\n        // Note:globalAlphaの初期値が1であることは仕様上保証されているため、常に掛け合わせる\n        this.context.globalAlpha *= opacity;\n    };\n    Context2DRenderer.prototype.save = function () {\n        this.context.save();\n    };\n    Context2DRenderer.prototype.restore = function () {\n        this.context.restore();\n    };\n    Context2DRenderer.prototype.fillRect = function (x, y, width, height, cssColor) {\n        var _fillStyle = this.context.fillStyle;\n        this.context.fillStyle = cssColor;\n        this.context.fillRect(x, y, width, height);\n        this.context.fillStyle = _fillStyle;\n    };\n    Context2DRenderer.prototype.setCompositeOperation = function (operation) {\n        this.context.globalCompositeOperation = RenderingHelper_1.RenderingHelper.toTextFromCompositeOperation(operation);\n    };\n    Context2DRenderer.prototype.setOpacity = function (opacity) {\n        this.context.globalAlpha = opacity;\n    };\n    Context2DRenderer.prototype.setTransform = function (matrix) {\n        this.context.setTransform.apply(this.context, matrix);\n    };\n    return Context2DRenderer;\n}(g.Renderer));\nexports.Context2DRenderer = Context2DRenderer;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.GlyphFactory = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar CanvasSurface_1 = require(\"./CanvasSurface\");\nfunction createGlyphRenderedSurface(code, fontSize, cssFontFamily, baselineHeight, marginW, marginH, needImageData, fontColor, strokeWidth, strokeColor, strokeOnly, fontWeight) {\n    // 要求されたフォントサイズが描画可能な最小フォントサイズ以下だった場合、必要なスケーリング係数\n    var scale = fontSize < GlyphFactory._environmentMinimumFontSize ? fontSize / GlyphFactory._environmentMinimumFontSize : 1;\n    var surfaceWidth = Math.ceil((fontSize + marginW * 2) * scale);\n    var surfaceHeight = Math.ceil((fontSize + marginH * 2) * scale);\n    var surface = new CanvasSurface_1.CanvasSurface(surfaceWidth, surfaceHeight);\n    // NOTE: canvasを直接操作する\n    // 理由:\n    // * Renderer#drawSystemText()を廃止または非推奨にしたいのでそれを用いず文字列を描画する\n    // * RenderingHelperがcontextの状態を復帰するためTextMetricsを取れない\n    var canvas = surface.canvas;\n    var context = canvas.getContext(\"2d\");\n    var str = (code & 0xFFFF0000) ? String.fromCharCode((code & 0xFFFF0000) >>> 16, code & 0xFFFF) : String.fromCharCode(code);\n    var fontWeightValue = fontWeight === g.FontWeight.Bold ? \"bold \" : \"\";\n    context.save();\n    // CanvasRenderingContext2D.font\n    // see: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font\n    // > This string uses the same syntax as the CSS font specifier. The default font is 10px sans-serif.\n    context.font = fontWeightValue + fontSize + \"px \" + cssFontFamily;\n    context.textAlign = \"left\";\n    context.textBaseline = \"alphabetic\";\n    context.lineJoin = \"bevel\";\n    // 描画可能な最小フォントサイズ以下のフォントサイズはスケーリングで実現する\n    if (scale !== 1)\n        context.scale(scale, scale);\n    if (strokeWidth > 0) {\n        context.lineWidth = strokeWidth;\n        context.strokeStyle = strokeColor;\n        context.strokeText(str, marginW, marginH + baselineHeight);\n    }\n    if (!strokeOnly) {\n        context.fillStyle = fontColor;\n        context.fillText(str, marginW, marginH + baselineHeight);\n    }\n    var advanceWidth = context.measureText(str).width;\n    context.restore();\n    var result = {\n        surface: surface,\n        advanceWidth: advanceWidth,\n        imageData: needImageData ? context.getImageData(0, 0, canvas.width, canvas.height) : undefined\n    };\n    return result;\n}\nfunction calcGlyphArea(imageData) {\n    var sx = imageData.width;\n    var sy = imageData.height;\n    var ex = 0;\n    var ey = 0;\n    var currentPos = 0;\n    for (var y = 0, height = imageData.height; y < height; y = (y + 1) | 0) {\n        for (var x = 0, width = imageData.width; x < width; x = (x + 1) | 0) {\n            var a = imageData.data[currentPos + 3]; // get alpha value\n            if (a !== 0) {\n                if (x < sx) {\n                    sx = x;\n                }\n                if (x > ex) {\n                    ex = x;\n                }\n                if (y < sy) {\n                    sy = y;\n                }\n                if (y > ey) {\n                    ey = y;\n                }\n            }\n            currentPos += 4; // go to next pixel\n        }\n    }\n    var glyphArea = undefined;\n    if (sx === imageData.width) { // 空白文字\n        glyphArea = { x: 0, y: 0, width: 0, height: 0 }; // 空の領域に設定\n    }\n    else {\n        // sx, sy, ex, eyは座標ではなく画素のメモリ上の位置を指す添字。\n        // 故にwidth, heightを算出する時 1 加算する。\n        glyphArea = { x: sx, y: sy, width: ex - sx + 1, height: ey - sy + 1 };\n    }\n    return glyphArea;\n}\nfunction isGlyphAreaEmpty(glyphArea) {\n    return glyphArea.width === 0 || glyphArea.height === 0;\n}\nfunction fontFamily2FontFamilyName(fontFamily) {\n    switch (fontFamily) {\n        case g.FontFamily.Monospace:\n            return \"monospace\";\n        case g.FontFamily.Serif:\n            return \"serif\";\n        default:\n            return \"sans-serif\";\n    }\n}\n// ジェネリックフォントファミリとして定義されているキーワードのリスト\n// see: https://developer.mozilla.org/en-US/docs/Web/CSS/font-family\nvar genericFontFamilyNames = [\n    \"serif\", \"sans-serif\", \"monospace\", \"cursive\", \"fantasy\", \"system-ui\"\n];\n// ジェネリックフォントファミリでない時クォートする。\n// > Font family names must either be given quoted as strings, or unquoted as a sequence of one or more identifiers.\n// > Generic family names are keywords and must not be quoted.\n// see: https://developer.mozilla.org/en-US/docs/Web/CSS/font-family\nfunction quoteIfNotGeneric(name) {\n    if (genericFontFamilyNames.indexOf(name) !== -1) {\n        return name;\n    }\n    else {\n        return \"\\\"\" + name + \"\\\"\";\n    }\n}\nfunction fontFamily2CSSFontFamily(fontFamily) {\n    if (typeof fontFamily === \"number\") {\n        return fontFamily2FontFamilyName(fontFamily);\n    }\n    else if (typeof fontFamily === \"string\") {\n        return quoteIfNotGeneric(fontFamily);\n    }\n    else {\n        return fontFamily.map(function (font) {\n            if (typeof font === \"string\") {\n                return quoteIfNotGeneric(font);\n            }\n            else {\n                return fontFamily2FontFamilyName(font);\n            }\n        }).join(\",\");\n    }\n}\nvar GlyphFactory = /** @class */ (function (_super) {\n    __extends(GlyphFactory, _super);\n    function GlyphFactory(fontFamily, fontSize, baselineHeight, fontColor, strokeWidth, strokeColor, strokeOnly, fontWeight) {\n        var _this = _super.call(this, fontFamily, fontSize, baselineHeight, fontColor, strokeWidth, strokeColor, strokeOnly, fontWeight) || this;\n        _this._glyphAreas = {};\n        _this._cssFontFamily = fontFamily2CSSFontFamily(fontFamily);\n        // Akashicエンジンは指定されたフォントに利用可能なものが見つからない時\n        // `g.FontFamily.SansSerif` を利用する、と仕様して定められている。\n        var fallbackFontFamilyName = fontFamily2FontFamilyName(g.FontFamily.SansSerif);\n        if (_this._cssFontFamily.indexOf(fallbackFontFamilyName) === -1) {\n            _this._cssFontFamily += \",\" + fallbackFontFamilyName;\n        }\n        // `this.fontSize`の大きさの文字を描画するためのサーフェスを生成する。\n        // 一部の文字は縦横が`this.fontSize`幅の矩形に収まらない。\n        // そこで上下左右にマージンを設ける。マージン幅は`this.fontSize`に\n        // 0.3 を乗じたものにする。0.3に確たる根拠はないが、検証した範囲では\n        // これで十分であることを確認している。\n        //\n        // strokeWidthサポートに伴い、輪郭線の厚みを加味している。\n        _this._marginW = Math.ceil(_this.fontSize * 0.3 + _this.strokeWidth / 2);\n        _this._marginH = Math.ceil(_this.fontSize * 0.3 + _this.strokeWidth / 2);\n        if (GlyphFactory._environmentMinimumFontSize === undefined) {\n            GlyphFactory._environmentMinimumFontSize = _this.measureMinimumFontSize();\n        }\n        return _this;\n    }\n    GlyphFactory.prototype.create = function (code) {\n        var result;\n        var glyphArea = this._glyphAreas[code];\n        if (!glyphArea) {\n            result = createGlyphRenderedSurface(code, this.fontSize, this._cssFontFamily, this.baselineHeight, this._marginW, this._marginH, true, this.fontColor, this.strokeWidth, this.strokeColor, this.strokeOnly, this.fontWeight);\n            glyphArea = calcGlyphArea(result.imageData);\n            glyphArea.advanceWidth = result.advanceWidth;\n            this._glyphAreas[code] = glyphArea;\n        }\n        if (isGlyphAreaEmpty(glyphArea)) {\n            if (result) {\n                result.surface.destroy();\n            }\n            return new g.Glyph(code, 0, 0, 0, 0, 0, 0, glyphArea.advanceWidth, undefined, true);\n        }\n        else {\n            // g.Glyphに格納するサーフェスを生成する。\n            // glyphAreaはサーフェスをキャッシュしないため、描画する内容を持つグリフに対しては\n            // サーフェスを生成する。もし前段でcalcGlyphArea()のためのサーフェスを生成して\n            // いればここでは生成せずにそれを利用する。\n            if (!result) {\n                result = createGlyphRenderedSurface(code, this.fontSize, this._cssFontFamily, this.baselineHeight, this._marginW, this._marginH, false, this.fontColor, this.strokeWidth, this.strokeColor, this.strokeOnly, this.fontWeight);\n            }\n            return new g.Glyph(code, glyphArea.x, glyphArea.y, glyphArea.width, glyphArea.height, glyphArea.x - this._marginW, glyphArea.y - this._marginH, glyphArea.advanceWidth, result.surface, true);\n        }\n    };\n    // 実行環境の描画可能なフォントサイズの最小値を返す\n    GlyphFactory.prototype.measureMinimumFontSize = function () {\n        var fontSize = 1;\n        var str = \"M\";\n        var canvas = document.createElement(\"canvas\");\n        var context = canvas.getContext(\"2d\");\n        context.textAlign = \"left\";\n        context.textBaseline = \"alphabetic\";\n        context.lineJoin = \"bevel\";\n        var preWidth;\n        context.font = fontSize + \"px sans-serif\";\n        var width = context.measureText(str).width;\n        do {\n            preWidth = width;\n            fontSize += 1;\n            context.font = fontSize + \"px sans-serif\";\n            width = context.measureText(str).width;\n        } while (preWidth === width || fontSize > 50); // フォントサイズに対応しない動作環境の場合を考慮して上限値を設ける\n        return fontSize;\n    };\n    return GlyphFactory;\n}(g.GlyphFactory));\nexports.GlyphFactory = GlyphFactory;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RenderingHelper = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar SurfaceFactory_1 = require(\"./SurfaceFactory\");\nvar RenderingHelper;\n(function (RenderingHelper) {\n    function toTextFromCompositeOperation(operation) {\n        var operationText;\n        switch (operation) {\n            case g.CompositeOperation.SourceAtop:\n                operationText = \"source-atop\";\n                break;\n            case g.CompositeOperation.Lighter:\n                operationText = \"lighter\";\n                break;\n            case g.CompositeOperation.Copy:\n                operationText = \"copy\";\n                break;\n            default:\n                operationText = \"source-over\";\n                break;\n        }\n        return operationText;\n    }\n    RenderingHelper.toTextFromCompositeOperation = toTextFromCompositeOperation;\n    function toCompositeOperationFromText(operationText) {\n        var operation;\n        switch (operationText) {\n            case \"source-atop\":\n                operation = g.CompositeOperation.SourceAtop;\n                break;\n            case \"lighter\":\n                operation = g.CompositeOperation.Lighter;\n                break;\n            case \"copy\":\n                operation = g.CompositeOperation.Copy;\n                break;\n            default:\n                operation = g.CompositeOperation.SourceOver;\n                break;\n        }\n        return operation;\n    }\n    RenderingHelper.toCompositeOperationFromText = toCompositeOperationFromText;\n    function drawSystemTextByContext2D(context, text, x, y, maxWidth, fontSize, textAlign, textBaseline, textColor, fontFamily, strokeWidth, strokeColor, strokeOnly) {\n        var fontFamilyValue;\n        var textAlignValue;\n        var textBaselineValue;\n        context.save();\n        switch (fontFamily) {\n            case g.FontFamily.Monospace:\n                fontFamilyValue = \"monospace\";\n                break;\n            case g.FontFamily.Serif:\n                fontFamilyValue = \"serif\";\n                break;\n            default:\n                fontFamilyValue = \"sans-serif\";\n                break;\n        }\n        context.font = fontSize + \"px \" + fontFamilyValue;\n        switch (textAlign) {\n            case g.TextAlign.Right:\n                textAlignValue = \"right\";\n                break;\n            case g.TextAlign.Center:\n                textAlignValue = \"center\";\n                break;\n            default:\n                textAlignValue = \"left\";\n                break;\n        }\n        context.textAlign = textAlignValue;\n        switch (textBaseline) {\n            case g.TextBaseline.Top:\n                textBaselineValue = \"top\";\n                break;\n            case g.TextBaseline.Middle:\n                textBaselineValue = \"middle\";\n                break;\n            case g.TextBaseline.Bottom:\n                textBaselineValue = \"bottom\";\n                break;\n            default:\n                textBaselineValue = \"alphabetic\";\n                break;\n        }\n        context.textBaseline = textBaselineValue;\n        context.lineJoin = \"bevel\";\n        if (strokeWidth > 0) {\n            context.lineWidth = strokeWidth;\n            context.strokeStyle = strokeColor;\n            if (typeof maxWidth === \"undefined\") {\n                context.strokeText(text, x, y);\n            }\n            else {\n                context.strokeText(text, x, y, maxWidth);\n            }\n        }\n        if (!strokeOnly) {\n            context.fillStyle = textColor;\n            if (typeof maxWidth === \"undefined\") {\n                context.fillText(text, x, y);\n            }\n            else {\n                context.fillText(text, x, y, maxWidth);\n            }\n        }\n        context.restore();\n    }\n    RenderingHelper.drawSystemTextByContext2D = drawSystemTextByContext2D;\n    function createPrimarySurface(width, height, rendererCandidates) {\n        return SurfaceFactory_1.SurfaceFactory.createPrimarySurface(width, height, rendererCandidates);\n    }\n    RenderingHelper.createPrimarySurface = createPrimarySurface;\n    function createBackSurface(width, height, platform, rendererCandidates) {\n        return SurfaceFactory_1.SurfaceFactory.createBackSurface(width, height, platform, rendererCandidates);\n    }\n    RenderingHelper.createBackSurface = createBackSurface;\n})(RenderingHelper = exports.RenderingHelper || (exports.RenderingHelper = {}));\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SurfaceFactory = void 0;\nvar CanvasSurface_1 = require(\"./CanvasSurface\");\nvar SurfaceFactory;\n(function (SurfaceFactory) {\n    function createPrimarySurface(width, height, rendererCandidates) {\n        return new CanvasSurface_1.CanvasSurface(width, height);\n    }\n    SurfaceFactory.createPrimarySurface = createPrimarySurface;\n    function createBackSurface(width, height, platform, rendererCandidates) {\n        return new CanvasSurface_1.CanvasSurface(width, height);\n    }\n    SurfaceFactory.createBackSurface = createBackSurface;\n})(SurfaceFactory = exports.SurfaceFactory || (exports.SurfaceFactory = {}));\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InputAbstractHandler = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar pdi = require(\"@akashic/akashic-pdi\");\n/**\n * 入力ハンドラ。\n *\n * コンストラクタで受け取ったViewに対してDOMイベントのハンドラを設定する。\n * DOMイベント情報から `PointEventResponse` へ変換したデータを `point{Down, Move, Up}Trigger` を通して通知する。\n * Down -> Move -> Up のフローにおける、Moveイベントのロックを管理する。\n */\nvar InputAbstractHandler = /** @class */ (function () {\n    /**\n     * @param inputView inputViewはDOMイベントを設定するHTMLElement\n     */\n    function InputAbstractHandler(inputView, disablePreventDefault) {\n        if (Object.getPrototypeOf && (Object.getPrototypeOf(this) === InputAbstractHandler.prototype)) {\n            throw new Error(\"InputAbstractHandler is abstract and should not be directly instantiated\");\n        }\n        this.inputView = inputView;\n        this.pointerEventLock = {};\n        this._xScale = 1;\n        this._yScale = 1;\n        this._disablePreventDefault = !!disablePreventDefault;\n        this.pointTrigger = new g.Trigger();\n    }\n    // `start()` で設定するDOMイベントをサポートしているかを返す\n    InputAbstractHandler.isSupported = function () {\n        return false;\n    };\n    // 継承したクラスにおいて、適切なDOMイベントを設定する\n    InputAbstractHandler.prototype.start = function () {\n        throw new Error(\"This method is abstract\");\n    };\n    // start() に対応するDOMイベントを開放する\n    InputAbstractHandler.prototype.stop = function () {\n        throw new Error(\"This method is abstract\");\n    };\n    InputAbstractHandler.prototype.setScale = function (xScale, yScale) {\n        if (yScale === void 0) { yScale = xScale; }\n        this._xScale = xScale;\n        this._yScale = yScale;\n    };\n    InputAbstractHandler.prototype.pointDown = function (identifier, pagePosition) {\n        this.pointTrigger.fire({\n            type: 0 /* Down */,\n            identifier: identifier,\n            offset: this.getOffsetFromEvent(pagePosition)\n        });\n        // downのイベントIDを保存して、moveとupのイベントの抑制をする(ロックする)\n        this.pointerEventLock[identifier] = true;\n    };\n    InputAbstractHandler.prototype.pointMove = function (identifier, pagePosition) {\n        if (!this.pointerEventLock.hasOwnProperty(identifier + \"\")) {\n            return;\n        }\n        this.pointTrigger.fire({\n            type: 1 /* Move */,\n            identifier: identifier,\n            offset: this.getOffsetFromEvent(pagePosition)\n        });\n    };\n    InputAbstractHandler.prototype.pointUp = function (identifier, pagePosition) {\n        if (!this.pointerEventLock.hasOwnProperty(identifier + \"\")) {\n            return;\n        }\n        this.pointTrigger.fire({\n            type: 2 /* Up */,\n            identifier: identifier,\n            offset: this.getOffsetFromEvent(pagePosition)\n        });\n        // Upが完了したら、Down->Upが完了したとしてロックを外す\n        delete this.pointerEventLock[identifier];\n    };\n    InputAbstractHandler.prototype.getOffsetFromEvent = function (e) {\n        return { x: e.offsetX, y: e.offsetY };\n    };\n    InputAbstractHandler.prototype.getScale = function () {\n        return { x: this._xScale, y: this._yScale };\n    };\n    return InputAbstractHandler;\n}());\nexports.InputAbstractHandler = InputAbstractHandler;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MouseHandler = void 0;\nvar InputAbstractHandler_1 = require(\"./InputAbstractHandler\");\nvar MouseHandler = /** @class */ (function (_super) {\n    __extends(MouseHandler, _super);\n    function MouseHandler(inputView, disablePreventDefault) {\n        var _this = _super.call(this, inputView, disablePreventDefault) || this;\n        var identifier = 1;\n        _this.onMouseDown = function (e) {\n            if (e.button !== 0)\n                return; // NOTE: 左クリック以外を受け付けない\n            _this.eventTarget = e.target;\n            _this.pointDown(identifier, e);\n            window.addEventListener(\"mousemove\", _this.onMouseMove, false);\n            window.addEventListener(\"mouseup\", _this.onMouseUp, false);\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        };\n        _this.onMouseMove = function (e) {\n            if (e.target !== _this.eventTarget)\n                return; // 対象の要素が異なる場合、イベントを発火しない\n            _this.pointMove(identifier, e);\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        };\n        _this.onMouseUp = function (e) {\n            if (e.target !== _this.eventTarget)\n                return; // 対象の要素が異なる場合、イベントを発火しない\n            _this.pointUp(identifier, e);\n            window.removeEventListener(\"mousemove\", _this.onMouseMove, false);\n            window.removeEventListener(\"mouseup\", _this.onMouseUp, false);\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        };\n        return _this;\n    }\n    MouseHandler.prototype.start = function () {\n        this.inputView.addEventListener(\"mousedown\", this.onMouseDown, false);\n    };\n    MouseHandler.prototype.stop = function () {\n        this.inputView.removeEventListener(\"mousedown\", this.onMouseDown, false);\n    };\n    return MouseHandler;\n}(InputAbstractHandler_1.InputAbstractHandler));\nexports.MouseHandler = MouseHandler;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TouchHandler = void 0;\nvar MouseHandler_1 = require(\"./MouseHandler\");\nvar TouchHandler = /** @class */ (function (_super) {\n    __extends(TouchHandler, _super);\n    function TouchHandler(inputView, disablePreventDefault) {\n        var _this = _super.call(this, inputView, disablePreventDefault) || this;\n        _this.onTouchDown = function (e) {\n            var touches = e.changedTouches;\n            for (var i = 0, len = touches.length; i < len; i++) {\n                var touch = touches[i];\n                _this.pointDown(touch.identifier, _this.convertToPagePosition(touch));\n            }\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                if (e.cancelable)\n                    e.preventDefault();\n            }\n        };\n        _this.onTouchMove = function (e) {\n            var touches = e.changedTouches;\n            for (var i = 0, len = touches.length; i < len; i++) {\n                var touch = touches[i];\n                _this.pointMove(touch.identifier, _this.convertToPagePosition(touch));\n            }\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                if (e.cancelable)\n                    e.preventDefault();\n            }\n        };\n        _this.onTouchUp = function (e) {\n            var touches = e.changedTouches;\n            for (var i = 0, len = touches.length; i < len; i++) {\n                var touch = touches[i];\n                _this.pointUp(touch.identifier, _this.convertToPagePosition(touch));\n            }\n            if (!_this._disablePreventDefault) {\n                e.stopPropagation();\n                if (e.cancelable)\n                    e.preventDefault();\n            }\n        };\n        return _this;\n    }\n    TouchHandler.prototype.start = function () {\n        _super.prototype.start.call(this);\n        this.inputView.addEventListener(\"touchstart\", this.onTouchDown);\n        this.inputView.addEventListener(\"touchmove\", this.onTouchMove);\n        this.inputView.addEventListener(\"touchend\", this.onTouchUp);\n    };\n    TouchHandler.prototype.stop = function () {\n        _super.prototype.stop.call(this);\n        this.inputView.removeEventListener(\"touchstart\", this.onTouchDown);\n        this.inputView.removeEventListener(\"touchmove\", this.onTouchMove);\n        this.inputView.removeEventListener(\"touchend\", this.onTouchUp);\n    };\n    TouchHandler.prototype.convertToPagePosition = function (e) {\n        // windowの左上を0,0とした時のinputViewのoffsetを取得する\n        var bounding = this.inputView.getBoundingClientRect();\n        var scale = this.getScale();\n        return {\n            offsetX: (e.pageX - Math.round(window.pageXOffset + bounding.left)) / scale.x,\n            offsetY: (e.pageY - Math.round(window.pageYOffset + bounding.top)) / scale.y\n        };\n    };\n    return TouchHandler;\n}(MouseHandler_1.MouseHandler));\nexports.TouchHandler = TouchHandler;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AudioPluginManager = void 0;\n/*\n Audioプラグインを登録し、現在登録しているプラグインを管理するクラス\n\n TODO: 各Gameインスタンスが一つのAudioプラグインしか持たないので、\n PluginManagerが状態をもたずにGame自体にpluginを登録する方式もあり\n */\nvar AudioPluginManager = /** @class */ (function () {\n    function AudioPluginManager() {\n        this._activePlugin = null;\n    }\n    AudioPluginManager.prototype.getActivePlugin = function () {\n        return this._activePlugin;\n    };\n    // Audioプラグインに登録を行い、どれか一つでも成功ならtrue、それ以外はfalseを返す\n    AudioPluginManager.prototype.tryInstallPlugin = function (plugins) {\n        for (var i = 0, len = plugins.length; i < len; i++) {\n            var p = plugins[i];\n            if (p.isSupported) {\n                var PluginConstructor = p;\n                if (PluginConstructor.isSupported()) {\n                    this._activePlugin = new PluginConstructor();\n                    return true;\n                }\n            }\n            else {\n                this._activePlugin = p;\n                return true;\n            }\n        }\n        return false;\n    };\n    return AudioPluginManager;\n}());\nexports.AudioPluginManager = AudioPluginManager;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AudioPluginRegistry = void 0;\nvar audioPlugins = [];\nexports.AudioPluginRegistry = {\n    addPlugin: function (plugin) {\n        if (audioPlugins.indexOf(plugin) === -1) {\n            audioPlugins.push(plugin);\n        }\n    },\n    getRegisteredAudioPlugins: function () {\n        return audioPlugins;\n    },\n    clear: function () {\n        audioPlugins = [];\n    }\n};\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLAudioAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar HTMLAudioAsset = /** @class */ (function (_super) {\n    __extends(HTMLAudioAsset, _super);\n    function HTMLAudioAsset() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    HTMLAudioAsset.prototype._load = function (loader) {\n        var _this = this;\n        if (this.path == null) {\n            // 再生可能な形式がない。実際には鳴らない音声としてロード成功しておく\n            this.data = null;\n            setTimeout(function () { return loader._onAssetLoad(_this); }, 0);\n            return;\n        }\n        var audio = new Audio();\n        var startLoadingAudio = function (path, handlers) {\n            // autoplay は preload よりも優先されるため明示的にfalseとする\n            audio.autoplay = false;\n            audio.preload = \"none\";\n            audio.src = path;\n            _this._attachAll(audio, handlers);\n            /* tslint:disable */\n            // Firefoxはpreload=\"auto\"でないと読み込みされない\n            // preloadはブラウザに対するHint属性なので、どう扱うかはブラウザの実装次第となる\n            // https://html.spec.whatwg.org/multipage/embedded-content.html#attr-media-preload\n            // https://developer.mozilla.org/ja/docs/Web/HTML/Element/audio#attr-preload\n            // https://github.com/CreateJS/SoundJS/blob/e2d4842a84ff425ada861edb9f6e9b57f63d7caf/src/soundjs/htmlaudio/HTMLAudioSoundInstance.js#L147-147\n            /* tslint:enable:max-line-length */\n            audio.preload = \"auto\";\n            setAudioLoadInterval(audio, handlers);\n            audio.load();\n        };\n        var handlers = {\n            success: function () {\n                _this._detachAll(audio, handlers);\n                _this.data = audio;\n                loader._onAssetLoad(_this);\n                window.clearInterval(_this._intervalId);\n            },\n            error: function () {\n                _this._detachAll(audio, handlers);\n                _this.data = audio;\n                loader._onAssetError(_this, g.ExceptionFactory.createAssetLoadError(\"HTMLAudioAsset loading error\"));\n                window.clearInterval(_this._intervalId);\n            }\n        };\n        var setAudioLoadInterval = function (audio, handlers) {\n            // IE11において、canplaythroughイベントが正常に発火しない問題が確認されたため、その対処として以下の処理を行っている。\n            // なお、canplaythroughはreadyStateの値が4になった時点で呼び出されるイベントである。\n            // インターバルとして指定している100msに根拠は無い。\n            _this._intervalCount = 0;\n            _this._intervalId = window.setInterval(function () {\n                if (audio.readyState === 4) {\n                    handlers.success();\n                }\n                else {\n                    ++_this._intervalCount;\n                    // readyStateの値が4にならない状態が1分（100ms×600）続いた場合、\n                    // 読み込みに失敗したとする。1分という時間に根拠は無い。\n                    if (_this._intervalCount === 600) {\n                        handlers.error();\n                    }\n                }\n            }, 100);\n        };\n        // 暫定対応：後方互換性のため、aacファイルが無い場合はmp4へのフォールバックを試みる。\n        // この対応を止める際には、HTMLAudioPluginのsupportedExtensionsからaacを除外する必要がある。\n        if (this.path.slice(-4) === \".aac\" && HTMLAudioAsset.supportedFormats.indexOf(\"mp4\") !== -1) {\n            var altHandlers = {\n                success: handlers.success,\n                error: function () {\n                    _this._detachAll(audio, altHandlers);\n                    window.clearInterval(_this._intervalId);\n                    var altPath = _this.path.slice(0, _this.path.length - 4) + \".mp4\";\n                    startLoadingAudio(altPath, handlers);\n                }\n            };\n            startLoadingAudio(this.path, altHandlers);\n            return;\n        }\n        startLoadingAudio(this.path, handlers);\n    };\n    HTMLAudioAsset.prototype.cloneElement = function () {\n        return this.data ? new Audio(this.data.src) : null;\n    };\n    HTMLAudioAsset.prototype._assetPathFilter = function (path) {\n        if (HTMLAudioAsset.supportedFormats.indexOf(\"ogg\") !== -1) {\n            return g.PathUtil.addExtname(path, \"ogg\");\n        }\n        if (HTMLAudioAsset.supportedFormats.indexOf(\"aac\") !== -1) {\n            return g.PathUtil.addExtname(path, \"aac\");\n        }\n        // ここで検出されるのは最初にアクセスを試みるオーディオアセットのファイルパスなので、\n        // supportedFormatsに(後方互換性保持で使う可能性がある)mp4が含まれていても利用しない\n        return null;\n    };\n    HTMLAudioAsset.prototype._attachAll = function (audio, handlers) {\n        if (handlers.success) {\n            /* tslint:disable:max-line-length */\n            // https://developer.mozilla.org/en-US/docs/Web/Events/canplaythrough\n            // https://github.com/goldfire/howler.js/blob/1dad25cdd9d6982232050454e8b45411902efe65/howler.js#L372\n            // https://github.com/CreateJS/SoundJS/blob/e2d4842a84ff425ada861edb9f6e9b57f63d7caf/src/soundjs/htmlaudio/HTMLAudioSoundInstance.js#L145-145\n            /* tslint:enable:max-line-length */\n            audio.addEventListener(\"canplaythrough\", handlers.success, false);\n        }\n        if (handlers.error) {\n            // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events\n            // stalledはfetchして取れなかった時に起きるイベント\n            audio.addEventListener(\"stalled\", handlers.error, false);\n            audio.addEventListener(\"error\", handlers.error, false);\n            audio.addEventListener(\"abort\", handlers.error, false);\n        }\n    };\n    HTMLAudioAsset.prototype._detachAll = function (audio, handlers) {\n        if (handlers.success) {\n            audio.removeEventListener(\"canplaythrough\", handlers.success, false);\n        }\n        if (handlers.error) {\n            audio.removeEventListener(\"stalled\", handlers.error, false);\n            audio.removeEventListener(\"error\", handlers.error, false);\n            audio.removeEventListener(\"abort\", handlers.error, false);\n        }\n    };\n    return HTMLAudioAsset;\n}(g.AudioAsset));\nexports.HTMLAudioAsset = HTMLAudioAsset;\n",
    "\"use strict\";\n/// chrome66以降などのブラウザに導入されるAutoplay Policyに対応する\n// https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\nvar state = 0 /* Unknown */;\nvar suspendedAudioElements = [];\nvar HTMLAudioAutoplayHelper;\n(function (HTMLAudioAutoplayHelper) {\n    function setupChromeMEIWorkaround(audio) {\n        function playHandler() {\n            switch (state) {\n                case 0 /* Unknown */:\n                case 1 /* WaitingInteraction */: // 通常のケースではここには到達しないが、何らかの外因によって音を鳴らすことができた場合\n                    playSuspendedAudioElements();\n                    break;\n                case 2 /* Ready */:\n                    break;\n                default:\n                // do nothing\n            }\n            state = 2 /* Ready */;\n            clearTimeout(timer);\n        }\n        function suspendedHandler() {\n            audio.removeEventListener(\"play\", playHandler);\n            switch (state) {\n                case 0 /* Unknown */:\n                    suspendedAudioElements.push(audio);\n                    state = 1 /* WaitingInteraction */;\n                    setUserInteractListener();\n                    break;\n                case 1 /* WaitingInteraction */:\n                    suspendedAudioElements.push(audio);\n                    break;\n                case 2 /* Ready */:\n                    audio.play(); // suspendedHandler が呼ばれるまでに音が鳴らせるようになった場合\n                    break;\n                default:\n                // do nothing;\n            }\n        }\n        switch (state) {\n            case 0 /* Unknown */:\n                audio.addEventListener(\"play\", playHandler, true);\n                var timer = setTimeout(suspendedHandler, 100); // 明確な根拠はないが100msec待ってもplayされなければ再生できないと判断する\n                break;\n            case 1 /* WaitingInteraction */:\n                suspendedAudioElements.push(audio);\n                break;\n            case 2 /* Ready */:\n                break;\n            default:\n            // do nothing\n        }\n    }\n    HTMLAudioAutoplayHelper.setupChromeMEIWorkaround = setupChromeMEIWorkaround;\n})(HTMLAudioAutoplayHelper || (HTMLAudioAutoplayHelper = {}));\nfunction resumeHandler() {\n    playSuspendedAudioElements();\n    clearUserInteractListener();\n}\nfunction setUserInteractListener() {\n    document.addEventListener(\"keydown\", resumeHandler, true);\n    document.addEventListener(\"mousedown\", resumeHandler, true);\n    document.addEventListener(\"touchend\", resumeHandler, true);\n}\nfunction clearUserInteractListener() {\n    document.removeEventListener(\"keydown\", resumeHandler);\n    document.removeEventListener(\"mousedown\", resumeHandler);\n    document.removeEventListener(\"touchend\", resumeHandler);\n}\nfunction playSuspendedAudioElements() {\n    state = 2 /* Ready */;\n    suspendedAudioElements.forEach(function (audio) { return audio.play(); });\n    suspendedAudioElements = [];\n}\nmodule.exports = HTMLAudioAutoplayHelper;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLAudioPlayer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar autoPlayHelper = require(\"./HTMLAudioAutoplayHelper\");\nvar HTMLAudioPlayer = /** @class */ (function (_super) {\n    __extends(HTMLAudioPlayer, _super);\n    function HTMLAudioPlayer(system, manager) {\n        var _this = _super.call(this, system) || this;\n        _this._manager = manager;\n        _this._endedEventHandler = function () {\n            _this._onAudioEnded();\n        };\n        _this._onPlayEventHandler = function () {\n            _this._onPlayEvent();\n        };\n        _this._dummyDurationWaitTimer = null;\n        return _this;\n    }\n    HTMLAudioPlayer.prototype.play = function (asset) {\n        if (this.currentAudio) {\n            this.stop();\n        }\n        var audio = asset.cloneElement();\n        if (audio) {\n            autoPlayHelper.setupChromeMEIWorkaround(audio);\n            audio.volume = this._calculateVolume();\n            audio.play().catch(function (err) { });\n            audio.loop = asset.loop;\n            audio.addEventListener(\"ended\", this._endedEventHandler, false);\n            audio.addEventListener(\"play\", this._onPlayEventHandler, false);\n            this._isWaitingPlayEvent = true;\n            this._audioInstance = audio;\n        }\n        else {\n            // 再生できるオーディオがない場合。duration後に停止処理だけ行う(処理のみ進め音は鳴らさない)\n            this._dummyDurationWaitTimer = setTimeout(this._endedEventHandler, asset.duration);\n        }\n        _super.prototype.play.call(this, asset);\n    };\n    HTMLAudioPlayer.prototype.stop = function () {\n        if (!this.currentAudio) {\n            return;\n        }\n        this._clearEndedEventHandler();\n        if (this._audioInstance) {\n            if (!this._isWaitingPlayEvent) {\n                // _audioInstance が再び play されることは無いので、 removeEventListener(\"play\") する必要は無い\n                this._audioInstance.pause();\n                this._audioInstance = null;\n            }\n            else {\n                this._isStopRequested = true;\n            }\n        }\n        _super.prototype.stop.call(this);\n    };\n    HTMLAudioPlayer.prototype.changeVolume = function (volume) {\n        _super.prototype.changeVolume.call(this, volume);\n        if (this._audioInstance) {\n            this._audioInstance.volume = this._calculateVolume();\n        }\n    };\n    HTMLAudioPlayer.prototype._changeMuted = function (muted) {\n        _super.prototype._changeMuted.call(this, muted);\n        if (this._audioInstance) {\n            this._audioInstance.volume = this._calculateVolume();\n        }\n    };\n    HTMLAudioPlayer.prototype.notifyMasterVolumeChanged = function () {\n        if (this._audioInstance) {\n            this._audioInstance.volume = this._calculateVolume();\n        }\n    };\n    HTMLAudioPlayer.prototype._onAudioEnded = function () {\n        this._clearEndedEventHandler();\n        _super.prototype.stop.call(this);\n    };\n    HTMLAudioPlayer.prototype._clearEndedEventHandler = function () {\n        if (this._audioInstance)\n            this._audioInstance.removeEventListener(\"ended\", this._endedEventHandler, false);\n        if (this._dummyDurationWaitTimer != null) {\n            clearTimeout(this._dummyDurationWaitTimer);\n            this._dummyDurationWaitTimer = null;\n        }\n    };\n    // audio.play() は非同期なので、 play が開始される前に stop を呼ばれた場合はこのハンドラ到達時に停止する\n    HTMLAudioPlayer.prototype._onPlayEvent = function () {\n        if (!this._isWaitingPlayEvent)\n            return;\n        this._isWaitingPlayEvent = false;\n        if (this._isStopRequested) {\n            this._isStopRequested = false;\n            // _audioInstance が再び play されることは無いので、 removeEventListener(\"play\") する必要は無い\n            this._audioInstance.pause();\n            this._audioInstance = null;\n        }\n    };\n    HTMLAudioPlayer.prototype._calculateVolume = function () {\n        return this._muted ? 0 : this.volume * this._system.volume * this._manager.getMasterVolume();\n    };\n    return HTMLAudioPlayer;\n}(g.AudioPlayer));\nexports.HTMLAudioPlayer = HTMLAudioPlayer;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTMLAudioPlugin = void 0;\nvar HTMLAudioAsset_1 = require(\"./HTMLAudioAsset\");\nvar HTMLAudioPlayer_1 = require(\"./HTMLAudioPlayer\");\nvar HTMLAudioPlugin = /** @class */ (function () {\n    function HTMLAudioPlugin() {\n        this._supportedFormats = this._detectSupportedFormats();\n        HTMLAudioAsset_1.HTMLAudioAsset.supportedFormats = this.supportedFormats;\n    }\n    // https://github.com/Modernizr/Modernizr/blob/master/feature-detects/audio.js\n    // https://github.com/CreateJS/SoundJS/blob/master/src/soundjs/htmlaudio/HTMLAudioPlugin.js\n    HTMLAudioPlugin.isSupported = function () {\n        // Audio要素を実際に作って、canPlayTypeが存在するかで確認する\n        var audioElement = document.createElement(\"audio\");\n        var result = false;\n        try {\n            result = (audioElement.canPlayType !== undefined);\n        }\n        catch (e) {\n            // ignore Error\n        }\n        return result;\n    };\n    Object.defineProperty(HTMLAudioPlugin.prototype, \"supportedFormats\", {\n        get: function () {\n            return this._supportedFormats;\n        },\n        // TSLintのバグ - setterはreturn typeを書くとコンパイルエラー\n        /* tslint:disable:typedef */\n        // HTMLAudioAssetへ反映させるためsetterとする\n        set: function (supportedFormats) {\n            this._supportedFormats = supportedFormats;\n            HTMLAudioAsset_1.HTMLAudioAsset.supportedFormats = supportedFormats;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /* tslint:enable:typedef */\n    HTMLAudioPlugin.prototype.createAsset = function (id, assetPath, duration, system, loop, hint) {\n        return new HTMLAudioAsset_1.HTMLAudioAsset(id, assetPath, duration, system, loop, hint);\n    };\n    HTMLAudioPlugin.prototype.createPlayer = function (system, manager) {\n        return new HTMLAudioPlayer_1.HTMLAudioPlayer(system, manager);\n    };\n    HTMLAudioPlugin.prototype._detectSupportedFormats = function () {\n        // Edgeは再生できるファイル形式とcanPlayTypeの結果が一致しないため、固定でAACを利用する\n        if (navigator.userAgent.indexOf(\"Edge/\") !== -1)\n            return [\"aac\"];\n        // Audio要素を実際に作って、canPlayTypeで再生できるかを判定する\n        var audioElement = document.createElement(\"audio\");\n        var supportedFormats = [];\n        try {\n            var supportedExtensions = [\"ogg\", \"aac\", \"mp4\"];\n            for (var i = 0, len = supportedExtensions.length; i < len; i++) {\n                var ext = supportedExtensions[i];\n                var canPlay = audioElement.canPlayType(\"audio/\" + ext);\n                var supported = (canPlay !== \"no\" && canPlay !== \"\");\n                if (supported) {\n                    supportedFormats.push(ext);\n                }\n            }\n        }\n        catch (e) {\n            // ignore Error\n        }\n        return supportedFormats;\n    };\n    return HTMLAudioPlugin;\n}());\nexports.HTMLAudioPlugin = HTMLAudioPlugin;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProxyAudioAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar ProxyAudioAsset = /** @class */ (function (_super) {\n    __extends(ProxyAudioAsset, _super);\n    function ProxyAudioAsset(handlerSet, id, assetPath, duration, system, loop, hint) {\n        var _this = _super.call(this, id, assetPath, duration, system, loop, hint) || this;\n        _this._handlerSet = handlerSet;\n        return _this;\n    }\n    ProxyAudioAsset.prototype.destroy = function () {\n        this._handlerSet.unloadAudioAsset(this.id);\n        _super.prototype.destroy.call(this);\n    };\n    ProxyAudioAsset.prototype._load = function (loader) {\n        var _this = this;\n        this._handlerSet.loadAudioAsset({\n            id: this.id,\n            assetPath: this.path,\n            duration: this.duration,\n            loop: this.loop,\n            hint: this.hint\n        }, function (err) {\n            if (err) {\n                loader._onAssetError(_this, g.ExceptionFactory.createAssetLoadError(err));\n            }\n            else {\n                loader._onAssetLoad(_this);\n            }\n        });\n    };\n    ProxyAudioAsset.prototype._assetPathFilter = function (path) {\n        return path;\n    };\n    return ProxyAudioAsset;\n}(g.AudioAsset));\nexports.ProxyAudioAsset = ProxyAudioAsset;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProxyAudioPlayer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar ProxyAudioPlayer = /** @class */ (function (_super) {\n    __extends(ProxyAudioPlayer, _super);\n    function ProxyAudioPlayer(handlerSet, system, manager) {\n        var _this = _super.call(this, system) || this;\n        _this._audioPlayerId = null;\n        _this._handlerSet = handlerSet;\n        _this._manager = manager;\n        return _this;\n    }\n    ProxyAudioPlayer.prototype.changeVolume = function (volume) {\n        _super.prototype.changeVolume.call(this, volume);\n        this._notifyVolumeToHandler();\n    };\n    ProxyAudioPlayer.prototype._changeMuted = function (muted) {\n        _super.prototype._changeMuted.call(this, muted);\n        this._notifyVolumeToHandler();\n    };\n    ProxyAudioPlayer.prototype.play = function (asset) {\n        if (this._audioPlayerId != null) {\n            this.stop();\n        }\n        this._audioPlayerId = \"ap\" + ProxyAudioPlayer._audioPlayerIdCounter++;\n        this._handlerSet.createAudioPlayer({\n            assetId: asset.id,\n            audioPlayerId: this._audioPlayerId,\n            isPlaying: true,\n            volume: this._calculateVolume(),\n            playbackRate: 1 // 未使用\n        });\n        _super.prototype.play.call(this, asset);\n    };\n    ProxyAudioPlayer.prototype.stop = function () {\n        if (this._audioPlayerId != null) {\n            this._handlerSet.stopAudioPlayer(this._audioPlayerId);\n            this._handlerSet.destroyAudioPlayer(this._audioPlayerId);\n            this._audioPlayerId = null;\n        }\n        _super.prototype.stop.call(this);\n    };\n    ProxyAudioPlayer.prototype.notifyMasterVolumeChanged = function () {\n        this._notifyVolumeToHandler();\n    };\n    ProxyAudioPlayer.prototype._notifyVolumeToHandler = function () {\n        if (this._audioPlayerId != null) {\n            this._handlerSet.changeAudioVolume(this._audioPlayerId, this._calculateVolume());\n        }\n    };\n    ProxyAudioPlayer.prototype._calculateVolume = function () {\n        return this._muted ? 0 : this.volume * this._system.volume * this._manager.getMasterVolume();\n    };\n    ProxyAudioPlayer._audioPlayerIdCounter = 0;\n    return ProxyAudioPlayer;\n}(g.AudioPlayer));\nexports.ProxyAudioPlayer = ProxyAudioPlayer;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProxyAudioPlugin = void 0;\nvar ProxyAudioAsset_1 = require(\"./ProxyAudioAsset\");\nvar ProxyAudioPlayer_1 = require(\"./ProxyAudioPlayer\");\nvar ProxyAudioPlugin = /** @class */ (function () {\n    function ProxyAudioPlugin(handlerSet) {\n        this.supportedFormats = [];\n        this._handlerSet = handlerSet;\n    }\n    ProxyAudioPlugin.isSupported = function () {\n        return true;\n    };\n    ProxyAudioPlugin.prototype.createAsset = function (id, assetPath, duration, system, loop, hint) {\n        return new ProxyAudioAsset_1.ProxyAudioAsset(this._handlerSet, id, assetPath, duration, system, loop, hint);\n    };\n    ProxyAudioPlugin.prototype.createPlayer = function (system, manager) {\n        return new ProxyAudioPlayer_1.ProxyAudioPlayer(this._handlerSet, system, manager);\n    };\n    return ProxyAudioPlugin;\n}());\nexports.ProxyAudioPlugin = ProxyAudioPlugin;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebAudioAsset = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar XHRLoader_1 = require(\"../../utils/XHRLoader\");\nvar helper = require(\"./WebAudioHelper\");\nvar WebAudioAsset = /** @class */ (function (_super) {\n    __extends(WebAudioAsset, _super);\n    function WebAudioAsset() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    WebAudioAsset.prototype._load = function (loader) {\n        var _this = this;\n        if (this.path == null) {\n            // 再生可能な形式がない。実際には鳴らない音声としてロード成功しておく\n            this.data = null;\n            setTimeout(function () { return loader._onAssetLoad(_this); }, 0);\n            return;\n        }\n        var successHandler = function (decodedAudio) {\n            _this.data = decodedAudio;\n            loader._onAssetLoad(_this);\n        };\n        var errorHandler = function () {\n            loader._onAssetError(_this, g.ExceptionFactory.createAssetLoadError(\"WebAudioAsset unknown loading error\"));\n        };\n        var onLoadArrayBufferHandler = function (response) {\n            var audioContext = helper.getAudioContext();\n            audioContext.decodeAudioData(response, successHandler, errorHandler);\n        };\n        var xhrLoader = new XHRLoader_1.XHRLoader();\n        var loadArrayBuffer = function (path, onSuccess, onFailed) {\n            xhrLoader.getArrayBuffer(path, function (error, response) {\n                error ? onFailed(error) : onSuccess(response);\n            });\n        };\n        if (this.path.slice(-4) === \".aac\") {\n            // 暫定対応：後方互換性のため、aacファイルが無い場合はmp4へのフォールバックを試みる。\n            // この対応を止める際には、WebAudioPluginのsupportedExtensionsからaacを除外する必要がある。\n            loadArrayBuffer(this.path, onLoadArrayBufferHandler, function (error) {\n                var altPath = _this.path.slice(0, _this.path.length - 4) + \".mp4\";\n                loadArrayBuffer(altPath, function (response) {\n                    _this.path = altPath;\n                    onLoadArrayBufferHandler(response);\n                }, errorHandler);\n            });\n            return;\n        }\n        loadArrayBuffer(this.path, onLoadArrayBufferHandler, errorHandler);\n    };\n    WebAudioAsset.prototype._assetPathFilter = function (path) {\n        if (WebAudioAsset.supportedFormats.indexOf(\"ogg\") !== -1) {\n            return g.PathUtil.addExtname(path, \"ogg\");\n        }\n        if (WebAudioAsset.supportedFormats.indexOf(\"aac\") !== -1) {\n            return g.PathUtil.addExtname(path, \"aac\");\n        }\n        // ここで検出されるのは最初にアクセスを試みるオーディオアセットのファイルパスなので、\n        // supportedFormatsに(後方互換性保持で使う可能性がある)mp4が含まれていても利用しない\n        return null;\n    };\n    // _assetPathFilterの判定処理を小さくするため、予めサポートしてる拡張子一覧を持つ\n    WebAudioAsset.supportedFormats = [];\n    return WebAudioAsset;\n}(g.AudioAsset));\nexports.WebAudioAsset = WebAudioAsset;\n",
    "\"use strict\";\nvar helper = require(\"./WebAudioHelper\");\n// chrome66以降などのブラウザに導入されるAutoplay Policyに対応する\n// https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\nvar WebAudioAutoplayHelper;\n(function (WebAudioAutoplayHelper) {\n    function setupChromeMEIWorkaround() {\n        var context = helper.getAudioContext();\n        if (context && typeof context.resume !== \"function\")\n            return;\n        var gain = helper.createGainNode(context);\n        // テスト用の音源を用意する\n        var osc = context.createOscillator();\n        osc.type = \"sawtooth\";\n        osc.frequency.value = 440; // 何でも良いがドの音\n        osc.connect(gain);\n        osc.start(0);\n        var contextState = context.state;\n        osc.disconnect();\n        if (contextState !== \"running\")\n            setUserInteractListener();\n    }\n    WebAudioAutoplayHelper.setupChromeMEIWorkaround = setupChromeMEIWorkaround;\n})(WebAudioAutoplayHelper || (WebAudioAutoplayHelper = {}));\nfunction resumeHandler() {\n    var context = helper.getAudioContext();\n    context.resume();\n    clearUserInteractListener();\n}\nfunction setUserInteractListener() {\n    document.addEventListener(\"keydown\", resumeHandler, true);\n    document.addEventListener(\"mousedown\", resumeHandler, true);\n    document.addEventListener(\"touchend\", resumeHandler, true);\n}\nfunction clearUserInteractListener() {\n    document.removeEventListener(\"keydown\", resumeHandler);\n    document.removeEventListener(\"mousedown\", resumeHandler);\n    document.removeEventListener(\"touchend\", resumeHandler);\n}\nmodule.exports = WebAudioAutoplayHelper;\n",
    "\"use strict\";\n// WebAudioのブラウザ間の差を吸収する\n// Compatible Table: http://compatibility.shwups-cms.ch/en/home?&property=AudioParam.prototype\n// http://qiita.com/mohayonao/items/d79e9fc56b4e9c157be1#polyfill\n// https://github.com/cwilso/webkitAudioContext-MonkeyPatch\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Porting_webkitAudioContext_code_to_standards_based_AudioContext\nvar AudioContext = window.AudioContext || window.webkitAudioContext;\nvar singleContext = null;\nvar WebAudioHelper;\n(function (WebAudioHelper) {\n    // AudioContextをシングルトンとして取得する\n    // 一つのページに一つのContextが存在すれば良い\n    function getAudioContext() {\n        if (!singleContext) {\n            singleContext = new AudioContext();\n            WebAudioHelper._workAroundSafari();\n        }\n        return singleContext;\n    }\n    WebAudioHelper.getAudioContext = getAudioContext;\n    function createGainNode(context) {\n        if (context.createGain) {\n            return context.createGain();\n        }\n        return context.createGainNode();\n    }\n    WebAudioHelper.createGainNode = createGainNode;\n    function createBufferNode(context) {\n        var sourceNode = context.createBufferSource();\n        // startがあるなら問題ないので、拡張しないで返す\n        if (sourceNode.start) {\n            return sourceNode;\n        }\n        // start/stopがない環境へのエイリアスを貼る\n        sourceNode.start = sourceNode.noteOn;\n        sourceNode.stop = sourceNode.noteOff;\n        return sourceNode;\n    }\n    WebAudioHelper.createBufferNode = createBufferNode;\n    // Safari対策ワークアラウンド\n    function _workAroundSafari() {\n        document.addEventListener(\"touchstart\", function touchInitializeHandler() {\n            document.removeEventListener(\"touchstart\", touchInitializeHandler);\n            singleContext.createBufferSource().start(0);\n        }, true);\n    }\n    WebAudioHelper._workAroundSafari = _workAroundSafari;\n})(WebAudioHelper || (WebAudioHelper = {}));\nmodule.exports = WebAudioHelper;\n",
    "\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebAudioPlayer = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar helper = require(\"./WebAudioHelper\");\nvar WebAudioPlayer = /** @class */ (function (_super) {\n    __extends(WebAudioPlayer, _super);\n    function WebAudioPlayer(system, manager) {\n        var _this = _super.call(this, system) || this;\n        _this._audioContext = helper.getAudioContext();\n        _this._manager = manager;\n        _this._gainNode = helper.createGainNode(_this._audioContext);\n        _this._gainNode.connect(_this._audioContext.destination);\n        _this._sourceNode = undefined;\n        _this._dummyDurationWaitTimer = null;\n        _this._endedEventHandler = function () {\n            _this._onAudioEnded();\n        };\n        return _this;\n    }\n    WebAudioPlayer.prototype.changeVolume = function (volume) {\n        _super.prototype.changeVolume.call(this, volume);\n        this._gainNode.gain.value = this._calculateVolume();\n    };\n    WebAudioPlayer.prototype._changeMuted = function (muted) {\n        _super.prototype._changeMuted.call(this, muted);\n        this._gainNode.gain.value = this._calculateVolume();\n    };\n    WebAudioPlayer.prototype.play = function (asset) {\n        if (this.currentAudio) {\n            this.stop();\n        }\n        if (asset.data) {\n            var bufferNode = helper.createBufferNode(this._audioContext);\n            bufferNode.loop = asset.loop;\n            bufferNode.buffer = asset.data;\n            this._gainNode.gain.value = this._calculateVolume();\n            bufferNode.connect(this._gainNode);\n            this._sourceNode = bufferNode;\n            // Chromeだとevent listerで指定した場合に動かないことがある\n            // https://github.com/mozilla-appmaker/appmaker/issues/1984\n            this._sourceNode.onended = this._endedEventHandler;\n            this._sourceNode.start(0);\n        }\n        else {\n            // 再生できるオーディオがない場合。duration後に停止処理だけ行う(処理のみ進め音は鳴らさない)\n            this._dummyDurationWaitTimer = setTimeout(this._endedEventHandler, asset.duration);\n        }\n        _super.prototype.play.call(this, asset);\n    };\n    WebAudioPlayer.prototype.stop = function () {\n        if (!this.currentAudio) {\n            return;\n        }\n        this._clearEndedEventHandler();\n        if (this._sourceNode)\n            this._sourceNode.stop(0);\n        _super.prototype.stop.call(this);\n    };\n    WebAudioPlayer.prototype.notifyMasterVolumeChanged = function () {\n        this._gainNode.gain.value = this._calculateVolume();\n    };\n    WebAudioPlayer.prototype._onAudioEnded = function () {\n        this._clearEndedEventHandler();\n        _super.prototype.stop.call(this);\n    };\n    WebAudioPlayer.prototype._clearEndedEventHandler = function () {\n        if (this._sourceNode)\n            this._sourceNode.onended = null;\n        if (this._dummyDurationWaitTimer != null) {\n            clearTimeout(this._dummyDurationWaitTimer);\n            this._dummyDurationWaitTimer = null;\n        }\n    };\n    WebAudioPlayer.prototype._calculateVolume = function () {\n        return this._muted ? 0 : this.volume * this._system.volume * this._manager.getMasterVolume();\n    };\n    return WebAudioPlayer;\n}(g.AudioPlayer));\nexports.WebAudioPlayer = WebAudioPlayer;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebAudioPlugin = void 0;\nvar WebAudioAsset_1 = require(\"./WebAudioAsset\");\nvar WebAudioPlayer_1 = require(\"./WebAudioPlayer\");\nvar autoPlayHelper = require(\"./WebAudioAutoplayHelper\");\nvar WebAudioPlugin = /** @class */ (function () {\n    /* tslint:enable:typedef */\n    function WebAudioPlugin() {\n        this.supportedFormats = this._detectSupportedFormats();\n        autoPlayHelper.setupChromeMEIWorkaround();\n    }\n    // AudioContextが存在するかどうかで判定する\n    // http://mohayonao.hatenablog.com/entry/2012/12/12/103009\n    // https://github.com/Modernizr/Modernizr/blob/master/feature-detects/audio/webaudio.js\n    WebAudioPlugin.isSupported = function () {\n        if (\"AudioContext\" in window) {\n            return true;\n        }\n        else if (\"webkitAudioContext\" in window) {\n            return true;\n        }\n        return false;\n    };\n    Object.defineProperty(WebAudioPlugin.prototype, \"supportedFormats\", {\n        get: function () {\n            return this._supportedFormats;\n        },\n        // TSLintのバグ - setterはreturn typeを書くとコンパイルエラーとなる\n        /* tslint:disable:typedef */\n        // WebAudioAssetへサポートしているフォーマット一覧を渡す\n        set: function (supportedFormats) {\n            this._supportedFormats = supportedFormats;\n            WebAudioAsset_1.WebAudioAsset.supportedFormats = supportedFormats;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WebAudioPlugin.prototype.createAsset = function (id, assetPath, duration, system, loop, hint) {\n        return new WebAudioAsset_1.WebAudioAsset(id, assetPath, duration, system, loop, hint);\n    };\n    WebAudioPlugin.prototype.createPlayer = function (system, manager) {\n        return new WebAudioPlayer_1.WebAudioPlayer(system, manager);\n    };\n    WebAudioPlugin.prototype._detectSupportedFormats = function () {\n        // Edgeは再生できるファイル形式とcanPlayTypeの結果が一致しないため、固定でAACを利用する\n        if (navigator.userAgent.indexOf(\"Edge/\") !== -1)\n            return [\"aac\"];\n        // Audio要素を実際に作って、canPlayTypeで再生できるかを判定する\n        var audioElement = document.createElement(\"audio\");\n        var supportedFormats = [];\n        try {\n            var supportedExtensions = [\"ogg\", \"aac\", \"mp4\"];\n            for (var i = 0, len = supportedExtensions.length; i < len; i++) {\n                var ext = supportedExtensions[i];\n                var canPlay = audioElement.canPlayType(\"audio/\" + ext);\n                var supported = (canPlay !== \"no\" && canPlay !== \"\");\n                if (supported) {\n                    supportedFormats.push(ext);\n                }\n            }\n        }\n        catch (e) {\n            // ignore Error\n        }\n        return supportedFormats;\n    };\n    return WebAudioPlugin;\n}());\nexports.WebAudioPlugin = WebAudioPlugin;\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.XHRLoader = void 0;\nvar g = require(\"@akashic/akashic-engine\");\nvar XHRLoader = /** @class */ (function () {\n    function XHRLoader(options) {\n        if (options === void 0) { options = {}; }\n        // デフォルトのタイムアウトは15秒\n        // TODO: タイムアウト値はこれが妥当であるか後日詳細を検討する\n        this.timeout = options.timeout || 15000;\n    }\n    XHRLoader.prototype.get = function (url, callback) {\n        this._getRequestObject({\n            url: url,\n            responseType: \"text\"\n        }, callback);\n    };\n    XHRLoader.prototype.getArrayBuffer = function (url, callback) {\n        this._getRequestObject({\n            url: url,\n            responseType: \"arraybuffer\"\n        }, callback);\n    };\n    XHRLoader.prototype._getRequestObject = function (requestObject, callback) {\n        var request = new XMLHttpRequest();\n        request.open(\"GET\", requestObject.url, true);\n        request.responseType = requestObject.responseType;\n        request.timeout = this.timeout;\n        request.addEventListener(\"timeout\", function () {\n            callback(g.ExceptionFactory.createAssetLoadError(\"loading timeout\"));\n        }, false);\n        request.addEventListener(\"load\", function () {\n            if (request.status >= 200 && request.status < 300) {\n                // \"text\" とそれ以外で取得方法を分類する\n                var response = requestObject.responseType === \"text\" ? request.responseText : request.response;\n                callback(null, response);\n            }\n            else {\n                callback(g.ExceptionFactory.createAssetLoadError(\"loading error. status: \" + request.status));\n            }\n        }, false);\n        request.addEventListener(\"error\", function () {\n            callback(g.ExceptionFactory.createAssetLoadError(\"loading error. status: \" + request.status));\n        }, false);\n        request.send();\n    };\n    return XHRLoader;\n}());\nexports.XHRLoader = XHRLoader;\n",
    "\"use strict\";\n",
    "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProxyAudioPlugin = exports.WebAudioPlugin = exports.HTMLAudioPlugin = exports.AudioPluginRegistry = exports.g = exports.ResourceFactory = exports.Platform = void 0;\nvar Platform_1 = require(\"./Platform\");\nObject.defineProperty(exports, \"Platform\", { enumerable: true, get: function () { return Platform_1.Platform; } });\nvar ResourceFactory_1 = require(\"./ResourceFactory\");\nObject.defineProperty(exports, \"ResourceFactory\", { enumerable: true, get: function () { return ResourceFactory_1.ResourceFactory; } });\n// akashic-engine内部でresourceを使えるように初期設定\nvar g = require(\"@akashic/akashic-engine\");\nexports.g = g;\nvar AudioPluginRegistry_1 = require(\"./plugin/AudioPluginRegistry\");\nObject.defineProperty(exports, \"AudioPluginRegistry\", { enumerable: true, get: function () { return AudioPluginRegistry_1.AudioPluginRegistry; } });\nvar AudioPluginManager_1 = require(\"./plugin/AudioPluginManager\");\nObject.defineProperty(exports, \"AudioPluginManager\", { enumerable: true, get: function () { return AudioPluginManager_1.AudioPluginManager; } });\n// TODO: Audio Pluginの実態は別リポジトリに切り出す事を検討する\nvar HTMLAudioPlugin_1 = require(\"./plugin/HTMLAudioPlugin/HTMLAudioPlugin\");\nObject.defineProperty(exports, \"HTMLAudioPlugin\", { enumerable: true, get: function () { return HTMLAudioPlugin_1.HTMLAudioPlugin; } });\nvar WebAudioPlugin_1 = require(\"./plugin/WebAudioPlugin/WebAudioPlugin\");\nObject.defineProperty(exports, \"WebAudioPlugin\", { enumerable: true, get: function () { return WebAudioPlugin_1.WebAudioPlugin; } });\nvar ProxyAudioPlugin_1 = require(\"./plugin/ProxyAudioPlugin/ProxyAudioPlugin\");\nObject.defineProperty(exports, \"ProxyAudioPlugin\", { enumerable: true, get: function () { return ProxyAudioPlugin_1.ProxyAudioPlugin; } });\n"
  ]
}